// Copyright 2022 SaferPlace

syntax = "proto3";

package review.v1;

import "incident/v1/incident.proto";

option go_package = "api.safer.place/review/v1;review";

// Review API
//
// The review API is used by the reviewers to decide the faith of a given report
service ReviewService {
    // ViewIncident displays the incident information for review.
    rpc ViewIncident(ViewIncidentRequest) returns (ViewIncidentResponse);
    // ReviewIncident allows the client to send reviewed incident.
    rpc ReviewIncident(ReviewIncidentRequest) returns (ReviewIncidentResponse);
    // IncidentsWithoutReview shows basic information about incidents which
    // have not been reviewed yet.
    rpc IncidentsWithoutReview(IncidentsWithoutReviewRequest)
        returns (IncidentsWithoutReviewResponse);
}

// ViewIncidentRequest will show the incident based on the given id.
message ViewIncidentRequest {
    string id = 1;
}

// ViewIncidentResponse returns the incident for review.
message ViewIncidentResponse {
    incident.v1.Incident incident = 1;
}

// IncomingIncidentRequest has the incident on which the reviewer should respond.
message ReviewIncidentRequest {
    // Id of the incident that the response is given to
    string id = 1;
    // Comment left by the reviewer
    string comment = 2;
    // Resolution of the review. If the resolution is UNSPECIFIED, it means that
    // the incident has not reached a final review and will be re-scheduled for
    // review.
    incident.v1.Resolution resolution = 3;
}

// ReviewIncidentResponse is empty
message ReviewIncidentResponse {
    
}

// IncidentsWithoutReviewRequest is send to see all the reviews which have
// the resolution set as UNSPECIFIED
message IncidentsWithoutReviewRequest {

}

// BasicIncidentDetails are send without are the bare minimum used to display
// the incident.
message BasicIncidentDetails {
    string id = 1;
    int64 timestamp = 2;
    string description = 3;
}

// IncidentsWithoutReviewResponse contains the list of basic incident details
message IncidentsWithoutReviewResponse {
    repeated BasicIncidentDetails incidents = 1;
}
